#!/usr/bin/ruby -w

#--------------------
# accept and serve files
#
# $Id$

require 'getoptlong'
require 'puppet/filebucket'

	#[ "--size",	"-s",			GetoptLong::REQUIRED_ARGUMENT ],
result = GetoptLong.new(
	[ "--help",		"-h",			GetoptLong::NO_ARGUMENT ]
)

result.each { |opt,arg|
	case opt
		when "--help"
			puts "There is no help yet"
			exit
		else
			raise "Invalid option '#{opt}'"
	end
}

begin
    server = FileBucket::BucketWebserver.new(
        :Bucket => File.expand_path("~/.puppet/bucket"),
        :Debug => true,
        :Port => 8080
    )
    trap(:INT) { server.shutdown }
    server.start
    #server = FileBucket::BucketServer.new(
    #    :Bucket => File.expand_path("~/.puppet/bucket")
    #)
rescue => detail
    $stderr.puts detail
    exit(1)
end
